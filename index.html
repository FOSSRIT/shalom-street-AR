<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title id='title'>AR App</title>

		<!--CSS-->
		<!--<link rel="stylesheet" type="text/css" href="styles.css" />-->
		<link rel="stylesheet" href="Styles/base.css" type="text/css" media="screen" />


		<!--Modex.js Core Engine-->
		<!--Setup path variables (path to Modex.js folder from index)-->
		<script type="text/javascript">var _modPath = 'Modex.js'</script>
		<!--We preface our src with ../ because we're in the example folder and need to jump back one directory-->
		<script type="text/javascript" src="Modex.js/base/index.js" ></script>
		<script type="text/javascript" src="Modex.js/graphics/index.js" ></script>
		<script type="text/javascript" src="Modex.js/states/index.js" ></script>
		<script type="text/javascript" src="Modex.js/positioning/index.js" ></script>

		<!--Extensions we'll use-->
		<script type="text/javascript" src="Modex.js/extensions/extensionManager.js" ></script>
		<script type="text/javascript" src="Modex.js/extensions/touch.js" ></script>
		<script type="text/javascript" src="Modex.js/extensions/jsonLoader.js"></script>
		<script type="text/javascript" src="Modex.js/extensions/jsonBuilder.js"></script>


		<script type="text/javascript" src="AR_Backbone/MenuItem.js"></script>
		<script type="text/javascript" src="AR_Backbone/Browser.js"></script>
		<script type="text/javascript" src="AR_Backbone/Menu.js"></script>
		<script type="text/javascript" src="AR_Backbone/Viewer.js"></script>
		<script type="text/javascript" src="AR_Backbone/Page.js"></script>

		<!--Our modules and states-->

		<script>

			var main;
			var templates = {};

			var app = {
			    // Application Constructor
			    initialize: function() {
			        this.bindEvents();

			    },
			    // Bind Event Listeners
			    //
			    // Bind any events that are required on startup. Common events are:
			    // 'load', 'deviceready', 'offline', and 'online'.
			    bindEvents: function() {
			        document.addEventListener('deviceready', this.onDeviceReady, false);
			        //window.onload = this.onDeviceReady;
			    },

			    // deviceready Event Handler
			    //
			    // The scope of 'this' is the event. In order to call the 'receivedEvent'
			    // function, we must explicity call 'app.receivedEvent(...);'
			    onDeviceReady: function() {

			        //... some code would go here...
			        //app.receivedEvent('deviceready');
			        //make our app's main repository of information.
					var info = {}

					//Pass in our templates.
					info.templates = {};
					info.templates.menu_item_template = document.getElementById("menu_item_template");
					info.templates.menu_template = document.getElementById("menu_template");
					info.templates.viewer_template = document.getElementById("viewer_template");
					info.templates.viewer_content_template = document.getElementById("viewer_content_template");

					//Main
					info.main = document.getElementById("main");
					var canvas = document.getElementById('tempNeed');
					manager = Manager(canvas, canvas.getContext('2d'), 1);

					//var item = MenuItem(templates.menu_item_template, main, 5);
					//var browser = Browser(info);

					currentState = StateManager(Browser(info));
					Touch.DOMCollisions(currentState, document);
					manager.addModule(currentState);


			    },

			    onDeviceNotSupported: function() {
			        //If the device isn't supported.
			        alert('device not supported');
			    },


			    // Update DOM on a Received Event
			    receivedEvent: function(id) {
			        var parentElement = document.getElementById(id);
			        var listeningElement = parentElement.querySelector('.listening');
			        var receivedElement = parentElement.querySelector('.received');

			        listeningElement.setAttribute('style', 'display:none;');
			        receivedElement.setAttribute('style', 'display:block;');

			        console.log('Received Event: ' + id);
			    }
			};


		/*function resizeIFrame(id){
			var newheight=document.getElementById(id).contentWindow.postMessage('sizing?', '*');

		    //var newwidth=document.getElementById(id).contentWindow.document .body.scrollWidth;

		   
		  	//document.getElementById(id).style.getElementById(id).width= (newwidth) + "px";
		}

		handleSizingResponse = function(e) {
		  	document.getElementById('me').style.height= e.data;
		  	console.log(e.data);
		}

		window.addEventListener('message', handleSizingResponse, false);*/

		app.initialize();
		</script>
	</head>




	<!--Main app-->
	<body>
		<!--Canvas is width and height of the screen.-->
		<!--We'll need to set this stuff up so it goes full screen I guess.-->
		
		<!--<textarea id="bioSubmitBox" style="resize: none; visibility:hidden; position:absolute; left:10px; top:10px; width:400px; height:400px">Enter your superhero's bio here!</textarea> -->
		<canvas id="tempNeed" width="100px" height="100px" style="display:none;"></canvas>
		<div id="main">

		<!--<iframe id="me" src="Data/2014-2015/myContent.html" onLoad="resizeIFrame('me')"></iframe>-->
			

		</div>

		<div id="templates" style="display:none;">

			<!--Menu-->
				<!-- Menu -->
				<div id="menu_template" class="menu">
					<!--Upper bar-->
					<div class="title">
						<!--Required field-->
						<div class="title_tag">A title will go here.</div> 
						<!--Required filed-->
						<div class="camera_tag"></div>
					</div>

				</div>

				<!-- Menu Items -->
				<div id="menu_item_template" class="menu_item">
					<div class="section">
						<div class="title_tag">Section Title Goes Here</div>
					</div>
					<!--<div></div> Maybe not show sections?  Maybe just tell the percent of that section you've unlocked?-->
				</div>

				<div id="menu_popup_template" class="menu_popup">
					A message will go here.
				</div>

			<!--Viewer-->

				<div id="viewer_template">

					<div class="viewer_tag">

					</div>

					<div class="navigation">
						<div class="back_tag"></div>
						<div class="home_tag"></div>
						<div class="forward_tag"></div>
					</div>
				</div>

		</div>
	</body>

</html>